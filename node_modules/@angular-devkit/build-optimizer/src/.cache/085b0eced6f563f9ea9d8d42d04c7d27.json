{"remainingRequest":"/home/vdsancheza/Documents/MeanStack/some-grid/node_modules/@angular-devkit/build-optimizer/src/build-optimizer/webpack-loader.js??ref--3-1!/home/vdsancheza/Documents/MeanStack/some-grid/node_modules/ag-grid-enterprise/dist/lib/rowModels/serverSide/serverSideBlock.js","dependencies":[{"path":"/home/vdsancheza/Documents/MeanStack/some-grid/node_modules/ag-grid-enterprise/dist/lib/rowModels/serverSide/serverSideBlock.js","mtime":499162500000},{"path":"/home/vdsancheza/Documents/MeanStack/some-grid/node_modules/cache-loader/dist/cjs.js","mtime":1538485928640},{"path":"/home/vdsancheza/Documents/MeanStack/some-grid/node_modules/@angular-devkit/build-optimizer/src/build-optimizer/webpack-loader.js","mtime":1519266497000}],"contextDependencies":[],"result":["// ag-grid-enterprise v19.0.0\n\"use strict\";\nvar __extends = /*@__PURE__*/ require(\"tslib\").__extends;\nvar __decorate = /*@__PURE__*/ require(\"tslib\").__decorate;\nvar __metadata = /*@__PURE__*/ require(\"tslib\").__metadata;\nvar __param = /*@__PURE__*/ require(\"tslib\").__param;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ag_grid_community_1 = require(\"ag-grid-community\");\nvar ServerSideBlock = /*@__PURE__*/ (function (_super) {\n    __extends(ServerSideBlock, _super);\n    function ServerSideBlock(pageNumber, parentRowNode, params, parentCache) {\n        var _this = _super.call(this, pageNumber, params) || this;\n        _this.params = params;\n        _this.parentRowNode = parentRowNode;\n        _this.parentCache = parentCache;\n        _this.level = parentRowNode.level + 1;\n        _this.groupLevel = params.rowGroupCols ? _this.level < params.rowGroupCols.length : undefined;\n        _this.leafGroup = params.rowGroupCols ? _this.level === params.rowGroupCols.length - 1 : false;\n        return _this;\n    }\n    ServerSideBlock.prototype.init = function () {\n        this.usingTreeData = this.gridOptionsWrapper.isTreeData();\n        if (!this.usingTreeData && this.groupLevel) {\n            var groupColVo = this.params.rowGroupCols[this.level];\n            this.groupField = groupColVo.field;\n            this.rowGroupColumn = this.columnController.getRowGroupColumns()[this.level];\n        }\n        this.createNodeIdPrefix();\n        _super.prototype.init.call(this, {\n            context: this.context,\n            rowRenderer: this.rowRenderer\n        });\n    };\n    ServerSideBlock.prototype.setBeans = function (loggerFactory) {\n        this.logger = loggerFactory.create('ServerSideBlock');\n    };\n    ServerSideBlock.prototype.createNodeIdPrefix = function () {\n        var parts = [];\n        var rowNode = this.parentRowNode;\n        // pull keys from all parent nodes, but do not include the root node\n        while (rowNode.level >= 0) {\n            parts.push(rowNode.key);\n            rowNode = rowNode.parent;\n        }\n        if (parts.length > 0) {\n            this.nodeIdPrefix = parts.reverse().join('-') + '-';\n        }\n    };\n    ServerSideBlock.prototype.createIdForIndex = function (index) {\n        if (ag_grid_community_1._.exists(this.nodeIdPrefix)) {\n            return this.nodeIdPrefix + index.toString();\n        }\n        else {\n            return index.toString();\n        }\n    };\n    ServerSideBlock.prototype.getNodeIdPrefix = function () {\n        return this.nodeIdPrefix;\n    };\n    ServerSideBlock.prototype.getRow = function (displayRowIndex) {\n        // do binary search of tree\n        // http://oli.me.uk/2013/06/08/searching-javascript-arrays-with-a-binary-search/\n        var bottomPointer = this.getStartRow();\n        // the end row depends on whether all this block is used or not. if the virtual row count\n        // is before the end, then not all the row is used\n        var virtualRowCount = this.parentCache.getVirtualRowCount();\n        var endRow = this.getEndRow();\n        var actualEnd = (virtualRowCount < endRow) ? virtualRowCount : endRow;\n        var topPointer = actualEnd - 1;\n        if (ag_grid_community_1._.missing(topPointer) || ag_grid_community_1._.missing(bottomPointer)) {\n            console.warn(\"ag-grid: error: topPointer = \" + topPointer + \", bottomPointer = \" + bottomPointer);\n            return null;\n        }\n        while (true) {\n            var midPointer = Math.floor((bottomPointer + topPointer) / 2);\n            var currentRowNode = _super.prototype.getRowUsingLocalIndex.call(this, midPointer);\n            if (currentRowNode.rowIndex === displayRowIndex) {\n                return currentRowNode;\n            }\n            var childrenCache = currentRowNode.childrenCache;\n            if (currentRowNode.rowIndex === displayRowIndex) {\n                return currentRowNode;\n            }\n            else if (currentRowNode.expanded && childrenCache && childrenCache.isDisplayIndexInCache(displayRowIndex)) {\n                return childrenCache.getRow(displayRowIndex);\n            }\n            else if (currentRowNode.rowIndex < displayRowIndex) {\n                bottomPointer = midPointer + 1;\n            }\n            else if (currentRowNode.rowIndex > displayRowIndex) {\n                topPointer = midPointer - 1;\n            }\n        }\n    };\n    ServerSideBlock.prototype.setDataAndId = function (rowNode, data, index) {\n        var _this = this;\n        rowNode.stub = false;\n        if (ag_grid_community_1._.exists(data)) {\n            // if the user is not providing id's, then we build an id based on the index.\n            // for infinite scrolling, the index is used on it's own. for Server Side Row Model,\n            // we combine the index with the level and group key, so that the id is\n            // unique across the set.\n            //\n            // unique id is needed for selection (so selection can be maintained when\n            // doing server side sorting / filtering) - if user is not providing id's\n            // (and we use the indexes) then selection will not work between sorting &\n            // filtering.\n            //\n            // id's are also used by the row renderer for updating the dom as it identifies\n            // rowNodes by id\n            var idToUse = this.createIdForIndex(index);\n            rowNode.setDataAndId(data, idToUse);\n            rowNode.setRowHeight(this.gridOptionsWrapper.getRowHeightForNode(rowNode));\n            if (this.usingTreeData) {\n                var getServerSideGroupKey = this.gridOptionsWrapper.getServerSideGroupKeyFunc();\n                if (ag_grid_community_1._.exists(getServerSideGroupKey)) {\n                    rowNode.key = getServerSideGroupKey(rowNode.data);\n                }\n                var isServerSideGroup = this.gridOptionsWrapper.getIsServerSideGroupFunc();\n                if (ag_grid_community_1._.exists(isServerSideGroup)) {\n                    rowNode.group = isServerSideGroup(rowNode.data);\n                }\n            }\n            else if (rowNode.group) {\n                rowNode.key = this.valueService.getValue(this.rowGroupColumn, rowNode);\n                if (rowNode.key === null || rowNode.key === undefined) {\n                    ag_grid_community_1._.doOnce(function () {\n                        console.warn(\"null and undefined values are not allowed for server side row model keys\");\n                        if (_this.rowGroupColumn) {\n                            console.warn(\"column = \" + _this.rowGroupColumn.getId());\n                        }\n                        console.warn(\"data is \", rowNode.data);\n                    }, 'ServerSideBlock-CannotHaveNullOrUndefinedForKey');\n                }\n            }\n        }\n        else {\n            rowNode.setDataAndId(undefined, undefined);\n            rowNode.key = null;\n        }\n        if (this.usingTreeData || this.groupLevel) {\n            this.setGroupDataIntoRowNode(rowNode);\n            this.setChildCountIntoRowNode(rowNode);\n        }\n    };\n    ServerSideBlock.prototype.setChildCountIntoRowNode = function (rowNode) {\n        var getChildCount = this.gridOptionsWrapper.getChildCountFunc();\n        if (getChildCount) {\n            rowNode.allChildrenCount = getChildCount(rowNode.data);\n        }\n    };\n    ServerSideBlock.prototype.setGroupDataIntoRowNode = function (rowNode) {\n        var _this = this;\n        var groupDisplayCols = this.columnController.getGroupDisplayColumns();\n        var usingTreeData = this.gridOptionsWrapper.isTreeData();\n        groupDisplayCols.forEach(function (col) {\n            if (usingTreeData) {\n                if (ag_grid_community_1._.missing(rowNode.groupData)) {\n                    rowNode.groupData = {};\n                }\n                rowNode.groupData[col.getColId()] = rowNode.key;\n            }\n            else if (col.isRowGroupDisplayed(_this.rowGroupColumn.getId())) {\n                var groupValue = _this.valueService.getValue(_this.rowGroupColumn, rowNode);\n                if (ag_grid_community_1._.missing(rowNode.groupData)) {\n                    rowNode.groupData = {};\n                }\n                rowNode.groupData[col.getColId()] = groupValue;\n            }\n        });\n    };\n    ServerSideBlock.prototype.loadFromDatasource = function () {\n        var _this = this;\n        var params = this.createLoadParams();\n        setTimeout(function () {\n            _this.params.datasource.getRows(params);\n        }, 0);\n    };\n    ServerSideBlock.prototype.createBlankRowNode = function (rowIndex) {\n        var rowNode = _super.prototype.createBlankRowNode.call(this, rowIndex);\n        rowNode.group = this.groupLevel;\n        rowNode.leafGroup = this.leafGroup;\n        rowNode.level = this.level;\n        rowNode.uiLevel = this.level;\n        rowNode.parent = this.parentRowNode;\n        // stub gets set to true here, and then false when this rowNode gets it's data\n        rowNode.stub = true;\n        if (rowNode.group) {\n            rowNode.expanded = false;\n            rowNode.field = this.groupField;\n            rowNode.rowGroupColumn = this.rowGroupColumn;\n        }\n        return rowNode;\n    };\n    ServerSideBlock.prototype.createGroupKeys = function (groupNode) {\n        var keys = [];\n        var pointer = groupNode;\n        while (pointer.level >= 0) {\n            keys.push(pointer.key);\n            pointer = pointer.parent;\n        }\n        keys.reverse();\n        return keys;\n    };\n    ServerSideBlock.prototype.isPixelInRange = function (pixel) {\n        return pixel >= this.blockTop && pixel < (this.blockTop + this.blockHeight);\n    };\n    ServerSideBlock.prototype.getRowBounds = function (index, virtualRowCount) {\n        var start = this.getStartRow();\n        var end = this.getEndRow();\n        for (var i = start; i <= end; i++) {\n            // the blocks can have extra rows in them, if they are the last block\n            // in the cache and the virtual row count doesn't divide evenly by the\n            if (i >= virtualRowCount) {\n                continue;\n            }\n            var rowNode = this.getRowUsingLocalIndex(i);\n            if (rowNode) {\n                if (rowNode.rowIndex === index) {\n                    return {\n                        rowHeight: rowNode.rowHeight,\n                        rowTop: rowNode.rowTop\n                    };\n                }\n                if (rowNode.group && rowNode.expanded && ag_grid_community_1._.exists(rowNode.childrenCache)) {\n                    var serverSideCache = rowNode.childrenCache;\n                    if (serverSideCache.isDisplayIndexInCache(index)) {\n                        return serverSideCache.getRowBounds(index);\n                    }\n                }\n            }\n        }\n        console.error(\"ag-Grid: looking for invalid row index in Server Side Row Model, index=\" + index);\n        return null;\n    };\n    ServerSideBlock.prototype.getRowIndexAtPixel = function (pixel, virtualRowCount) {\n        var start = this.getStartRow();\n        var end = this.getEndRow();\n        for (var i = start; i <= end; i++) {\n            // the blocks can have extra rows in them, if they are the last block\n            // in the cache and the virtual row count doesn't divide evenly by the\n            if (i >= virtualRowCount) {\n                continue;\n            }\n            var rowNode = this.getRowUsingLocalIndex(i);\n            if (rowNode) {\n                if (rowNode.isPixelInRange(pixel)) {\n                    return rowNode.rowIndex;\n                }\n                if (rowNode.group && rowNode.expanded && ag_grid_community_1._.exists(rowNode.childrenCache)) {\n                    var serverSideCache = rowNode.childrenCache;\n                    if (serverSideCache.isPixelInRange(pixel)) {\n                        return serverSideCache.getRowIndexAtPixel(pixel);\n                    }\n                }\n            }\n        }\n        console.warn(\"ag-Grid: invalid pixel range for server side block \" + pixel);\n        return 0;\n    };\n    ServerSideBlock.prototype.clearRowTops = function (virtualRowCount) {\n        this.forEachRowNode(virtualRowCount, function (rowNode) {\n            rowNode.clearRowTop();\n            var hasChildCache = rowNode.group && ag_grid_community_1._.exists(rowNode.childrenCache);\n            if (hasChildCache) {\n                var serverSideCache = rowNode.childrenCache;\n                serverSideCache.clearRowTops();\n            }\n        });\n    };\n    ServerSideBlock.prototype.setDisplayIndexes = function (displayIndexSeq, virtualRowCount, nextRowTop) {\n        this.displayIndexStart = displayIndexSeq.peek();\n        this.blockTop = nextRowTop.value;\n        this.forEachRowNode(virtualRowCount, function (rowNode) {\n            var rowIndex = displayIndexSeq.next();\n            rowNode.setRowIndex(rowIndex);\n            rowNode.setRowTop(nextRowTop.value);\n            nextRowTop.value += rowNode.rowHeight;\n            var hasChildCache = rowNode.group && ag_grid_community_1._.exists(rowNode.childrenCache);\n            if (hasChildCache) {\n                var serverSideCache = rowNode.childrenCache;\n                if (rowNode.expanded) {\n                    serverSideCache.setDisplayIndexes(displayIndexSeq, nextRowTop);\n                }\n                else {\n                    // we need to clear the row tops, as the row renderer depends on\n                    // this to know if the row should be faded out\n                    serverSideCache.clearRowTops();\n                }\n            }\n        });\n        this.displayIndexEnd = displayIndexSeq.peek();\n        this.blockHeight = nextRowTop.value - this.blockTop;\n    };\n    ServerSideBlock.prototype.forEachRowNode = function (virtualRowCount, callback) {\n        var start = this.getStartRow();\n        var end = this.getEndRow();\n        for (var i = start; i <= end; i++) {\n            // the blocks can have extra rows in them, if they are the last block\n            // in the cache and the virtual row count doesn't divide evenly by the\n            if (i >= virtualRowCount) {\n                continue;\n            }\n            var rowNode = this.getRowUsingLocalIndex(i);\n            if (rowNode) {\n                callback(rowNode);\n            }\n        }\n    };\n    ServerSideBlock.prototype.createLoadParams = function () {\n        var groupKeys = this.createGroupKeys(this.parentRowNode);\n        var request = {\n            startRow: this.getStartRow(),\n            endRow: this.getEndRow(),\n            rowGroupCols: this.params.rowGroupCols,\n            valueCols: this.params.valueCols,\n            pivotCols: this.params.pivotCols,\n            pivotMode: this.params.pivotMode,\n            groupKeys: groupKeys,\n            filterModel: this.params.filterModel,\n            sortModel: this.params.sortModel\n        };\n        var params = {\n            successCallback: this.pageLoaded.bind(this, this.getVersion()),\n            failCallback: this.pageLoadFailed.bind(this),\n            request: request,\n            parentNode: this.parentRowNode\n        };\n        return params;\n    };\n    ServerSideBlock.prototype.isDisplayIndexInBlock = function (displayIndex) {\n        return displayIndex >= this.displayIndexStart && displayIndex < this.displayIndexEnd;\n    };\n    ServerSideBlock.prototype.isBlockBefore = function (displayIndex) {\n        return displayIndex >= this.displayIndexEnd;\n    };\n    ServerSideBlock.prototype.getDisplayIndexStart = function () {\n        return this.displayIndexStart;\n    };\n    ServerSideBlock.prototype.getDisplayIndexEnd = function () {\n        return this.displayIndexEnd;\n    };\n    ServerSideBlock.prototype.getBlockHeight = function () {\n        return this.blockHeight;\n    };\n    ServerSideBlock.prototype.getBlockTop = function () {\n        return this.blockTop;\n    };\n    ServerSideBlock.prototype.isGroupLevel = function () {\n        return this.groupLevel;\n    };\n    ServerSideBlock.prototype.getGroupField = function () {\n        return this.groupField;\n    };\n    __decorate([\n        ag_grid_community_1.Autowired('context'),\n        __metadata(\"design:type\", ag_grid_community_1.Context)\n    ], ServerSideBlock.prototype, \"context\", void 0);\n    __decorate([\n        ag_grid_community_1.Autowired('rowRenderer'),\n        __metadata(\"design:type\", ag_grid_community_1.RowRenderer)\n    ], ServerSideBlock.prototype, \"rowRenderer\", void 0);\n    __decorate([\n        ag_grid_community_1.Autowired('columnController'),\n        __metadata(\"design:type\", ag_grid_community_1.ColumnController)\n    ], ServerSideBlock.prototype, \"columnController\", void 0);\n    __decorate([\n        ag_grid_community_1.Autowired('valueService'),\n        __metadata(\"design:type\", ag_grid_community_1.ValueService)\n    ], ServerSideBlock.prototype, \"valueService\", void 0);\n    __decorate([\n        ag_grid_community_1.Autowired('gridOptionsWrapper'),\n        __metadata(\"design:type\", ag_grid_community_1.GridOptionsWrapper)\n    ], ServerSideBlock.prototype, \"gridOptionsWrapper\", void 0);\n    __decorate([\n        ag_grid_community_1.PostConstruct,\n        __metadata(\"design:type\", Function),\n        __metadata(\"design:paramtypes\", []),\n        __metadata(\"design:returntype\", void 0)\n    ], ServerSideBlock.prototype, \"init\", null);\n    __decorate([\n        __param(0, ag_grid_community_1.Qualifier('loggerFactory')),\n        __metadata(\"design:type\", Function),\n        __metadata(\"design:paramtypes\", [ag_grid_community_1.LoggerFactory]),\n        __metadata(\"design:returntype\", void 0)\n    ], ServerSideBlock.prototype, \"setBeans\", null);\n    return ServerSideBlock;\n}(ag_grid_community_1.RowNodeBlock));\nexports.ServerSideBlock = ServerSideBlock;\n",null]}